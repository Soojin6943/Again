
{% block content %}

{{ category }}
{{ centerLat }} {{ centerLon }}
<div id="map" style="width:100%; height:800px;"></div>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey="></script>
<script>
    var container = document.getElementById('map');
    var options = {
        center: new kakao.maps.LatLng(33.450701, 126.570667),
        level: 6
    };
    var map = new kakao.maps.Map(container, options);

    // 지도 확대 축소를 제어할 수 있는  줌 컨트롤을 생성합니다
    var zoomControl = new kakao.maps.ZoomControl();
    map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);

    var geocoder = new kakao.maps.services.Geocoder();
    console.log(geocoder);

    var positions = new Array();

    // 데이터들 넣기
    {% for mapL in mapList %}
        positions.push({
            title: '{{ mapL.title }}',
            address: '{{ mapL.location }}'
           })
    {% endfor %}

    positions.forEach(function (position) {
        geocoder.addressSearch(position.address, function(result, status) {

            if(status === kakao.maps.services.Status.OK) {
                var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

                var marker = new kakao.maps.Marker({
                    map: map, // 마커 표시할 지도
                    position: coords,  // 마커 표시할 위치
                    clickable: true
                });

                var iwContent = '<div style="width:150px; text-align:center; padding:6px 0;">' + position.title + '</div>',
                    iwRemoveable = true;

                var infowindow = new kakao.maps.InfoWindow({
                   content : iwContent,
                   removable : iwRemoveable
                });


                kakao.maps.event.addListener(marker, 'click', function() {
                    infowindow.open(map, marker);
                });



                map.setCenter(coords);
            }
        });
    });

</script>
{% endblock %}